<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>psparameterset on Jess Pomfret</title><link>https://jpomfret.github.io/tags/psparameterset/</link><description>Recent content in psparameterset on Jess Pomfret</description><generator>Hugo -- gohugo.io</generator><language>en-gb</language><lastBuildDate>Fri, 14 Dec 2018 00:00:00 +0000</lastBuildDate><atom:link href="https://jpomfret.github.io/tags/psparameterset/index.xml" rel="self" type="application/rss+xml"/><item><title>PSParameterSets: Mandatory sometimes</title><link>https://jpomfret.github.io/p/psparametersets-mandatory-sometimes/</link><pubDate>Fri, 14 Dec 2018 00:00:00 +0000</pubDate><guid>https://jpomfret.github.io/p/psparametersets-mandatory-sometimes/</guid><description>&lt;p>I came across a situation this week where I wanted to add the option of running an existing script,  for a specific server/database combination.  The script currently has no parameters and runs against all servers in the environment from a scheduled task.  I wanted to make sure that behavior didn’t change. The other requirement was that if I specified Server, Database should be a mandatory parameter and vice versa.&lt;/p>
&lt;p>The final solution was to add the two parameters to a parameter set and make them both mandatory.  I also had to add a different DefaultParameterSet (thanks to &lt;a class="link" href="http://twitter.com/awickham" target="_blank" rel="noopener"
>Andrew&lt;/a> for this idea), otherwise it defaulted to the defined parameter set, meaning the script always required both Server and Database parameters.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[CmdletBinding(DefaultParametersetname=&amp;#34;Normal&amp;#34;)]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">param (
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [Parameter(Mandatory = $True, ParameterSetName=&amp;#39;Specific&amp;#39;)]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [string]$ServerName,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [Parameter(Mandatory = $True, ParameterSetName=&amp;#39;Specific&amp;#39;)]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [string]$DatabaseName
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">if($PSCmdlet.ParameterSetName -eq &amp;#39;Normal&amp;#39;) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Write-Host &amp;#39;Running without params&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">} else {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Write-Host (&amp;#34;Server: {0}&amp;#34; -f $ServerName)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Write-Host (&amp;#34;Database: {0}&amp;#34; -f $DatabaseName)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I saved the above code as params.ps1 to ensure my test cases worked. As you can see in my testing below, I can still run params.ps1 without any parameters, this replicates the current behavior of my nightly job. &lt;/p>
&lt;p>I can also now pass in Server and Database parameters, if I specify one the script will prompt for the other since they are both required.&lt;/p>
&lt;p>&lt;img src="https://jpomfret.github.io/images/ParamsTest.jpg"
loading="lazy"
>&lt;/p></description></item></channel></rss>